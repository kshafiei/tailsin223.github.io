<!DOCTYPE html>
<html>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
<style>
	
	h1 {
		font-size: 80px;
	}

	#main {
		position: absolute;
  		left: 3%;
 		width: 94%;
  		border: 10px solid green;
  		padding: 7px;
		top: 20%;
	}

	#aBtn {
		margin: 10px;
	}

</style>

<body onload="setSchedule()">
	<div id="main">
		<h1 id="left">Time Left: </h1>
		<h1 id="end"> End of Period: </h1>
	</div>
	<input type="button" id="aBtn" value="Assembly Schedule" class="btn btn-primary" onclick="setAssembly()">
</body>

<script>

	var d = new Date();
	console.log(d);
	var h;
	var m;
	var s;
	var start;

	var schedule = {};
	var normSchedule = {};
	assembly = false;
	//0-Sunday 1-Monday... 6-Saturday

	function setSchedule() {
		day = d.getDay();
		
		if (day==1 && !assembly || day==2 && !assembly || day==5 && !assembly) {
			
			schedule = {
				0: ["08:30", "09:00"],
				1: ["09:00", "09:05"],
				2: ["09:05", "09:50"],
				3: ["09:50", "09:55"],
				4: ["09:55", "10:40"],
				5: ["10:40", "10:45"],
				6: ["10:45", "11:30"],
				7: ["11:30", "11:35"],
				8: ["11:35", "12:20"],
				9: ["12:20", "13:30"],
				10: ["13:30", "13:35"],
				11: ["13:35", "14:20"],
				12: ["14:20", "14:25"],
				13: ["14:25", "15:10"],
				14: ["15:10", "15:15"],
				15: ["15:15", "16:00"]
			}

			normSchedule = {
				0: ["08:30", "09:00"],
				1: ["09:00", "09:05"],
				2: ["09:05", "09:50"],
				3: ["09:50", "09:55"],
				4: ["09:55", "10:40"],
				5: ["10:40", "10:45"],
				6: ["10:45", "11:30"],
				7: ["11:30", "11:35"],
				8: ["11:35", "12:20"],
				9: ["12:20", "01:30"],
				10: ["01:30", "01:35"],
				11: ["01:35", "02:20"],
				12: ["02:20", "02:25"],
				13: ["02:25", "03:10"],
				14: ["03:10", "03:15"],
				15: ["03:15", "04:00"]
			}

		} else if (day==3 && !assembly|| day==4 && !assembly) {
			
			schedule = {
				1: ["08:30", "10:05"],
				2: ["10:05", "10:10"],
				3: ["10:10", "11:40"],
				4: ["11:40", "12:50"],
				5: ["12:50", "12:55"],
				6: ["12:55", "14:25"],
				7: ["14:25", "14:30"],
				8: ["14:30", "16:00"]
			}

			normSchedule = {
				1: ["08:30", "10:05"],
				2: ["10:05", "10:10"],
				3: ["10:10", "11:40"],
				4: ["11:40", "12:50"],
				5: ["12:50", "12:55"],
				6: ["12:55", "02:25"],
				7: ["02:25", "02:30"],
				8: ["02:30", "04:00"]
			}
		} else if (assembly) {
			
			schedule = {
				0: ["08:30", "09:15"],
				1: ["09:15", "09:20"],
				2: ["09:20", "10:00"],
				3: ["10:00", "10:05"],
				4: ["10:05", "10:45"],
				5: ["10:45", "11:55"],
				6: ["11:55", "13:00"],
				7: ["13:00", "13:05"],
				8: ["13:05", "13:45"],
				9: ["13:45", "13:50"],
				10: ["13:50", "14:30"],
				11: ["14:30", "14:35"],
				12: ["14:35", "15:15"],
				13: ["15:15", "15:20"],
				14: ["15:20", "16:00"]
			}

			normSchedule = {
				0: ["08:30", "09:15"],
				1: ["09:15", "09:20"],
				2: ["09:20", "10:00"],
				3: ["10:00", "10:05"],
				4: ["10:05", "10:45"],
				5: ["10:45", "11:55"],
				6: ["11:55", "01:00"],
				7: ["01:00", "01:05"],
				8: ["01:05", "01:45"],
				9: ["01:45", "01:50"],
				10: ["01:50", "02:30"],
				11: ["02:30", "02:35"],
				12: ["02:35", "03:15"],
				13: ["03:15", "03:20"],
				14: ["03:20", "04:00"]
			}
		}
		setTime();
	}

	function setAssembly() {
		if (assembly == false) {
			assembly = true;
		} else {
			assembly = false;
		}
		setSchedule();
	}

	window.setInterval(setTime, 1000);
	var intRed;
	var redVal;

	function redDown() {
		document.getElementById("left").style.color = "rgb(" + redVal + ", 0, 0)";
		if (redVal>0)
			redVal -= 1;
	}

	function zero(x) {
		if (x<10)
			return "0" + x;
		return x;
	}

	
	function getPeriod() {
		for(var i in schedule) {
			times = schedule[i][1].split(":");

			if (h==times[0])
				if (m<times[1])
					return i;

			if (h < times[0])
				return i;
		}
	}

	function setTime() {
		d = new Date();
		h = zero(String(d.getHours()));
		m = zero(String(d.getMinutes()));
		s = zero(String(d.getSeconds()));

		period = getPeriod();
		current = normSchedule[period][1];
		
		document.getElementById("end").innerHTML = "End of Period: " + current + ":00";

		timeEnd = schedule[period][1].split(":");

		leftH = Math.abs(parseInt(timeEnd[0])-h);
		if (leftH>12)
			leftH-=12;
		if (m>timeEnd[1])
			leftH--;
		leftH = zero(leftH);

		leftM = parseInt(timeEnd[1])-m-1;
		if (leftM<0) {
			leftM = zero(60+leftM);
		} else {
			leftM = zero(leftM);
		}

		leftS = zero(Math.abs(60-s));
		if (leftS==60) {
			leftM++;
			leftS="00";
		}
		document.getElementById("left").innerHTML = "Time Left: " + leftH + ":" + leftM + ":" + leftS;
		document.getElementById("left").style.color = "rgb(255, 0, 0)";
		
		redVal = 100;
		window.clearInterval(intRed);
		intRed = window.setInterval(redDown, 100);
	}

</script>

</html>


